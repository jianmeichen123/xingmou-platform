<div class="popup_password">
	<div class="popup_project_title"><span class="popup_ico"></span><span id="popup_name"></span></div>
    <div class="popup_password_center">
        <div class="form-group m_top15">
            <span class="password_hint_show" id='password_hint_show'></span>
        </div> 
        <div class="form-group group">
            <span  class="span">原密码</span>
            <input type="password" class="form-control ico_close" id="original_password" placeholder="请填写原密码">
        </div>
        <div class="form-group group">
            <span  class="span">新密码</span>
            <input type="password" class="form-control ico_open" id="newpassword" placeholder="请填写新密码">
        </div>
        <div class="form-group group">
       		<input type="password" class="form-control ico_open" id="oldpassword" placeholder="请再次确认新密码">
        </div>
        
        
    </div>
    <div class="popup_button  btn-primary" onclick="updatePwd()">确定</div>
</div>
<script>
// scrollables
		$('#original_password').bind({
		focus:function(){},
		blur:function(){
			original_password_input = $('#original_password').val();
			checkPwd(original_password_input);
			
		}
	});
		
function updatePwd() {
	
	var password = $('#newpassword').val();
	var  password1 = $('#oldpassword').val(); 
	var  original_password = $('#original_password').val(); 
	
	if($('#password_hint_show').html()=="原始密码不正确") {
		return;
		
	}
	if (original_password=="" ) {
		
		$('#password_hint_show').html("原始密码不能为空");
		return;
	}
	 
	if (password=="" || password1=="") {
		$('#password_hint_show').html("新密码不能为空");
		return;
	}
	if (password != password1) {
		$('#password_hint_show').html("两次密码输入不一致");
		return;
	}
	if(password.length<6 || password1.length<6){
		$('#password_hint_show').html("密码不小于6位");
		return;
	}
	if(password.length>12 || password1.length>12){
		$('#password_hint_show').html("密码不能大于12位");
		return;
	}
    var data = {};
	data["id"] = userId;
	 data["password"] = password;
	    
	 sendPostRequestByJsonObj(platformUrl.updatePwd, data, updatePwdCallback);
	 

}

function updatePwdCallback(data) {
	if(data.result.status == "OK") {
		$('#password_hint_show').html("密码修改成功");
		window.location.reload();
	} else {
		$('#password_hint_show').html("密码修改失败!");
		return false;
	}
}
var flag = false;
function checkPwd(password) {
	 var json = {};
	 json["password"]=password;
	 sendGetRequest(platformUrl.checkPwd, json, getPwdCallback);
}
function getPwdCallback(data) {
	flag = data.flag;
	var original_password_input;
	if(flag == false){
		$('#password_hint_show').html("原始密码不正确");
		return;
	}else{
		$('#password_hint_show').html("");
	}
}
</script>
